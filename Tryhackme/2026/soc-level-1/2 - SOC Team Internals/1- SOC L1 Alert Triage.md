
# SOC L1 Alert Triage

Learn more about SOC alerts and build a systematic approach to efficiently triaging them.

# TaskÂ 1 Introduction

An alert is a core concept for anyÂ SOCÂ team, and knowing how to handle it properly ultimately decides whether a security breach is detected and prevented, or missed and devastating. This is an entry level but essential room forÂ SOCÂ L1 analysts to understand the concept and lifecycle of alerts, from event generation to correct resolution.

## Learning Objectives

- Familiarise with the concept ofÂ SOCÂ alert
- Explore alert fields, statuses, and classification
- Learn how to perform alert triage as an L1 analyst
- Practice with real alerts andÂ SOCÂ workflows
- Prepare forÂ [SOCÂ Simulator](https://tryhackme.com/soc-sim)Â andÂ [SAL1](https://tryhackme.com/certification/security-analyst-level-1/details)Â certification

## Prerequisites

- Understand common attacks on networks, Windows, andÂ Linux
- KnowÂ SOCÂ roles and duties, especially of L1 analysts

## SOCÂ Dashboard

You were granted access to theÂ SOCÂ dashboard in the TryHackMeÂ SIEM, and you will need it to complete most of the tasks. Open the attached website in a separate window, familiarise yourself with it, and move on to the next task!

# TaskÂ 2 Events and Alerts

Imagine yourself as aÂ SOCÂ intern, looking at the monitor of your mentor, aÂ SOCÂ L1 or L2 analyst, and seeing hundreds of alerts appear, moving between statuses and eventually disappearing from some dashboard or console. You notice lots of alerts named "Email Marked asÂ Phishing", a few "Unusual Gmail Login Location", and one scary "Unapproved Mimikatz Usage" inside a red column. What are these alerts, how are they formed, and what should we do with them? Let's find out!

## From Events to Alerts

First, an event must occur, like user login, process launch, or file download. Then, the system, like yourÂ OS, aÂ firewall, or a cloud provider must log the event. After that, all system logs must be shipped to a security solution likeÂ SIEMÂ orÂ EDR. TheÂ SOCÂ team can receive millions of logs per day from thousands of different systems, where most of the events are expected, but some require attention.Â **Alert**, a notification generated by a security solution when a specific event or sequence of events occurs, is what savesÂ SOCÂ analysts from manual log review by highlighting only suspicious, anomalous events. With alerts, analysts triage just dozens of alerts per day instead of millions of raw logs.

**Alert Management Platforms**

| Solution         | Examples                      | Description                                                                                                                                                                       |
| ---------------- | ----------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| SIEM  <br>System | SplunkÂ ES,Â   <br>Elastic      | SIEMÂ have solid alert management capabilities and are a perfect choice for mostÂ SOCÂ teams                                                                                         |
| EDRÂ or  <br>NDR  | MS Defender,  <br>CrowdStrike | WhileÂ EDRÂ and NDR provide their own alert dashboards, it is preferred to useÂ SIEMÂ orÂ SOAR                                                                                         |
| SOAR  <br>System | SplunkÂ SOAR,  <br>CortexÂ SOAR | BiggerÂ SOCÂ teams can useÂ SOARÂ to aggregate and centralise alerts from multiple solutions                                                                                          |
| ITSM  <br>System | Jira,  <br>TheHive            | Some teams may have a custom ticket management (ITSM) setup using a dedicated solution  <br>(The GIF above is taken from Trello, a simple tool that can be adapted toÂ ITSMÂ needs) |
## L1 Role in Alert Triage

SOCÂ L1 analysts are the first line of defence, and they are the ones who work with alerts the most. Depending on various factors, L1 analysts may receive zero to a hundred alerts a day, every one of which can reveal a cyberattack. Still, everyone in theÂ SOCÂ team is somehow involved in the alert triage:

- **SOCÂ L1 analysts:**Â Â Review the alerts, distinguish bad from good, and notify L2 analysts in case of a real threat
- **SOCÂ L2 analysts:**Â Â Receive the alerts escalated by L1 analysts and perform deeper analysis and remediation
- **SOCÂ engineers:**Â Â Ensure the alerts contain enough information required for efficient alert triage
- **SOCÂ manager:**Â Â Track speed and quality of alert triage to ensure that real attacks won't be missed

## Answer the questions below

What is the number of alerts you see in theÂ [SOC dashboard](https://static-labs.tryhackme.cloud/apps/socl1-alerttriage/)?

 5

What is the name of the most recent alert you see?

Double-Extension File Creation


# TaskÂ 3 Alert Properties

Now that you know how alerts are generated, it's time to review their content. While the details differ for everyÂ SIEMÂ or security solution, the alerts generally have a few main properties you must understand before taking them. Don't worry if you find some confusing, as you will hear more about some in the upcoming tasks.

## Alert Properties

| â„–     | Property          | Description                                                                                                                | Examples                                                                                                                         |
| ----- | ----------------- | -------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------- |
| **1** | Alert Time        | Shows alert creation time. Alert usually triggers  <br>a few minutes after the actual event                                | - Alert Time: March 21, 15:35<br>- Event Time: March 21, 15:32                                                                   |
| **2** | Alert Name        | Provides a summary of what happened,  <br>based on the detection rule's name                                               | - Unusual Login Location<br>- Email Marked asÂ Phishing<br>- WindowsÂ RDPÂ Bruteforce<br>- Potential Data Exfiltration              |
| **3** | Alert Severity    | Defines the urgency of the alert,  <br>initially set by detection engineers,  <br>but can be altered by analysts if needed | - (ðŸŸ¢) Low / Informational<br>- (ðŸŸ¡) Medium / Moderate<br>- (ðŸŸ ) High / Severe<br>- (ðŸ”´) Critical / Urgent                       |
| **4** | Alert Status      | Informs if somebody is working on the alert  <br>or if the triage is done                                                  | - (ðŸ†•) New / Unassigned<br>- (ðŸ”„) In Progress / Pending<br>- (âœ…) Closed / Resolved<br>- And often other custom statuses          |
| **5** | Alert Verdict     | Also called alert classification,  <br>explains if the alert is a real threat or noise                                     | - (ðŸ”´) True Positive / Real Threat<br>- (ðŸŸ¢) False Positive / No Threat<br>- And often other custom verdicts                     |
| **6** | Alert Assignee    | Shows the analyst that was assigned  <br>or assigned themselves to review the alert                                        | - Assignee can sometimes be called alert owner<br>    <br>- Assignee takes responsibility for their alerts                       |
| **7** | Alert Description | Explains what the alert is about,  <br>usually in three sections on the right                                              | - The logic of the alert generating rule<br>- Why this activity can indicate an attack<br>- Optionally, how to triage this alert |
| **8** | Alert Fields      | ProvidesÂ SOCÂ analysts' comments  <br>and values on which the alert was triggered                                           | - Affected Hostname<br>- Entered Commandline<br>- And many more, depending on the aler                                           |
## Answer the questions below

What was the verdict for the "Unusual VPN Login Location" alert?

 False Positive

What user was mentioned in the "Unusual VPN Login Location" alert?

M.Clark


# TaskÂ 4 - Alert Prioritisation

Okay, you can now read and understand the alert. What's next? Recall the second task, where you see hundreds of alerts but have to choose which to pick up first. The process of deciding which to take is calledÂ **Alert Prioritisation**, and it is crucial to ensure timely detection of a threat, especially with many alerts in the queue.

## Picking the Right Alert

EveryÂ SOCÂ team decides on its own prioritisation rules and usually automates them by setting the appropriate alert sorting logic inÂ SIEMÂ orÂ EDR. Below, you may see the generic, simplest, and most commonly used approach:

1. **Filter the alerts**  
    Make sure you don't take the alert that other analysts have already reviewed, or that is already being investigated by one of your teammates. You should only take new, yet unseen and unresolved alerts.
2. **Sort by severity**  
    Start with critical alerts, then high, medium, and finally low. This is because detection engineers design rules so that critical alerts are much more likely to be real, major threats and cause much more impact than medium or low ones.
3. **Sort by time**  
    Start with the oldest alerts and end with the newest ones. The idea is that if both alerts are about two breaches, the hacker from the older breach is likely already dumping your data, while the "newcomer" has just started the discovery.

## Answer the questions below

Should you first prioritise mediumÂ over low severity alerts? (Yea/Nay)

 Yea

Should you first takeÂ the newest alerts and then the older ones? (Yea/Nay)

 Nay

Assign yourself to the first-priority alert and change its status toÂ **In Progress**.  
The name of your selected alert will be the answer to the question.

Potential Data Exfiltration

# TaskÂ 5 Alert Triage

Finally, you are ready to review the chosen alert! The process is quite operationally heavy, but you will soon see why every step is important. Also, note that the alert review byÂ SOCÂ analysts can also be called alert triage, alert handling, alert processing, alert investigation, or alert analysis. During this module, we will stick to theÂ **Alert Triage**Â option.

## Initial Actions

The initial steps are designed to ensure that you take ownership of the assigned alert and avoid interfering with alerts being handled by other analysts, and confirm that you are fully prepared to proceed with the detailed investigation. You achieve it by first assigning the alert to yourself, moving it toÂ **In Progress**, and then familiarising yourself with the alert details like its name, description, and key indicators.

## Investigation

This is the most complex step, requiring you to apply your technical knowledge and experience to understand the activity and properly analyse its legitimacy inÂ SIEMÂ orÂ EDRÂ logs. To support L1 analysts with this step, some teams developÂ **Workbooks**Â (also known as playbooks or runbooks) - instructions on how to investigate the specific category of alerts. If workbooks are not available, below are some key recommendations:

1. Understand who is under threat, like the affected user, hostname, cloud, network, or website
2. Note the action described in the alert, like whether it was a suspicious login, malware, orÂ phishing
3. Review surrounding events, looking for suspicious actions shortly after or before the alert
4. Use threat intelligence platforms or other available resources to verify your thoughts

## Final Actions

Your decisions here determine whether you found or missed the potential cyberattack. Some actions likeÂ **Escalation**Â orÂ **Commenting**Â will be explained in the following rooms, so don't worry if they sound complex right now. First, decide if the alert you investigated is malicious (True Positive) or not (False Positive). Then, prepare your detailed comment explaining your analysis steps and verdict reasoning, return to the dashboard and move it to theÂ **Closed**Â status.

**SOCÂ Dashboard Notes**

If you didn't receive a flag after your triage, it means that the values you set are wrong.  
You can reset theÂ SOCÂ dashboard by clickingÂ **Restart**Â on the top right in the TryHackMeÂ SIEM.

## Answer the questions below

Which flag did you receive after you correctly triaged the first-priority alert?

 THM{looks_like_lots_of_zoom_meetings}

Which flag did you receive after you correctly triaged the second-priority alert?

 THM{how_could_this_user_fall_for_it?}

Which flag did you receive after you correctly triaged the third-priority alert?

THM{should_we_allow_github_for_devs?}

# TaskÂ 6 Conclusion

Congratulations on successfully triaging the alerts! Of course, closing the alert as True Positive won't prevent the attack, but it is a great start. Next, you will learn about proper alert commenting and case reporting, correct escalation procedures, and actions made by L2 analysts after the escalation. We hope you enjoyed the room!

Answer the questions below

I am ready to move on!

